Website Todos
=============

- [x] Automatic parallels page
  - [x] Add more Marriage parallels
  - [ ] Parallelize readings
  - [ ] Add context 
    - [ ] source links
    - [ ] explanatory note for each liturgy
    - [ ] introductory note that the structure isn't the same for all liturgies
  - [ ] Bugs
    - [ ] remove response from all but last Text
    - [ ] remove label etc. from all but first doc
- [ ] Add RCL readings for Holy Week/Easter Vigil/etc.
- [ ] Lazy loading for `BiblicalCitation`s within `Choice`s
- Bugs
  - [x] LFF special days like Thursday/Friday/Saturday after Ash Wednesday
    - [ ] fallback day names and ranks
  - [ ] Don't show Holy Day page links for days like December 31, that have neither readings nor bio
  - [ ] Collect page numbers list *last* page, not first page, of collect (if it changes mid-collect)
  - [ ] Mark Feasts of the Incarnation 
  - [ ] Improve `minimal_markdown` function in `components/document.rs` so it can actually handle * and ** in any order
- Testing
  - [ ] Set up tests for compiling actual liturgies, with snapshotted JSON versions
- [ ] Add liturgies
  - [x] Service of Light/Order of Worship for Evening
  - [ ] Marriage liturgies
    - [ ] Check whether there are any other differences between LR1 and LR2
  - [ ] Rite I Office
  - [ ] Eucharistic liturgies
- [ ] Better Biblical citation reading parsing (paragraphs)
- [ ] Exports
  - [ ] docx
    - [ ] finish DOCX export code
  - [x] LDF JSON
  - [ ] Export menu on Document page
    - [ ] Link
    - [ ] Embed (iFrame)
    - [ ] Word
    - [ ] Venite
    - [x] JSON
- [ ] Fix LFF collects with empty labels
- [ ] Rite II collects need Version::RiteII, not default (Version::BCP1979)
- [ ] Systematic distinction between server date/current time (when rendering, either SSR or even more so SSG) and client current time/date — replaces instances where the prerendered UI accidentally assumes server time (e.g., Morning/Evening in daily readings page)
- [ ] Stored selections for certain Choices
- [ ] Psalter page
  - [ ] Page
  - [ ] In liturgy
- [ ] Prayers & Thanksgivings
- [ ] Error handling for pages: need to return a `Result` because possible path doesn't work if dynamic
- [ ] Figure out partial hydration again
- [ ] Merge this back into the Episcopal-API repo
- [ ] Sunday Readings page (a copy of Daily Readings, but use RCL?)
- [ ] CI/CD
- [ ] Additional library of documents
- [ ] Clean up Index page + links
- [ ] Additional preferences
  - [ ] MP/EP: Officiant is a layperson/deacon vs. priest (absolution)
- [ ] Additional Tests
	- [ ] Does each holy day have 2 LFF collects + LFF readings?
- [ ] Bugs
	- [ ] psalms_by_citation (for e.g., Psalm 106:1-5) not capturing verses correctly? (http://localhost:1234/en/holy-day/JohnMasonNeale)
	- [ ] Build actual pages for lookups
- [ ] Collects of the Day w/ two versions
    - [ ] Export
      - [x] Rite II
      - [x] Rite I
      - [ ] Rite II collect page #s
      - [ ] check Rite I against Rite II collects
      - [ ] Compare LFF Rite 1 and Rite 2
      - [ ] Sort LFF collects by date order
      - [ ] Sanity check on LFF collect names
      - [ ] LFF collect page #s
    - [ ] Compile in Library compiler
    - [x] Build page
      - [ ] Sort (Seasons of the Year, Holy Days, etc. as in prayer book)
      - [x] Search function
        - [ ] Debounce
      - [ ] Remove duplicates
    - [x] Links to page
    - [ ] Order collects by page
    - [ ] Add page numbers to collects
  - [x] Category
    - [x] Handle different versions (in link, and in page generation)
    - [x] Category pages (as distinct from document pages) with labels etc.
    - [ ] Group documents by label
  - [ ] Correct Document representations for hymn texts; some are Text, but some are Preces or Litany, especially in Service Music
  - [ ] Lectionary/Readings page: handle special things like Vigils, multiple Christmas services, etc.
  - [ ] Calendar
    - [ ] LFF propers for holy days
      - [x] Convert lectionary
      - [x] Add to /holy-day pages
      - [ ] Add missing doubled sets (marked with *or*, like All Saints’ Day)
      - [ ] Add to summary page
      - [ ] Sort the list
      - [ ] Add page numbers within LFF
      - [ ] Add "Preface of _____"
    - [ ] Add collects to holy-day pages
  - [ ] Psalter page
  - [ ] About page
- [ ] Local preferences for...
  - [ ] Choices on Daily Readings page
  - [ ] Choice on Calendar page
- [ ] Alternative web/HTML setup (Perseus/Sycamore)
  - [x] Build compiling based on date
  - [ ] Build preferences
  - [ ] Build static category pages
  - [ ] Use these components for the HTML export
- Calendar 
  - [ ] Make sure every feast has a day name
  - [ ] Filter `holy_days` field so it doesn't include: (note, this is for purposes of display)
    - the observed day
    - the alternate day
    - a red-letter day that was displaced by a Sunday
- [ ] Heroku deployment
  - [ ] API endpoint
    - [ ] eject and serve from Perseus Warp server?
    - [ ] separate endpoints for dev/prod 
- [ ] Improvements to BiblicalCitation async loading
  - [ ] Include paragraphs/spacing
  - Bugs
    - [ ] Proverbs 8:22-30 (12/27 St. John)
    - [ ] Wisdom 4:7-15 (when?)
    - [ ] Song of Songs http://localhost:1844/en/holy-day/AgnesAndCeciliaOfRome#first-lesson
- [ ] Morning Prayer
  - [ ] Clean up internal TODO items
  - [ ] rotate `Choice`s for things like prayers for mission and daily collects?
- [x] Preferences
  - [ ] Tests (in conditions)
- [ ] Canticle Tables
  - [ ] Compile
    - [ ] Fallbacks
    - [ ] Traditional language
  - [x] Port canticle tables over from JSON
    - [ ] "Classical" tables for Rite I + Rite II
  - [ ] Actually look up canticles (cf. Psalter)
  - [ ] Tests
- [ ] Liturgies
  - [x] Compline
  - [ ] Evening Prayer
  - [ ] Build preferences/choices into liturgies
  - [ ] Add many more source citations
- [ ] Compiler additions
  - [ ] Rotate/randomize
  - [ ] In-depth compiler tests to prevent future breakage
- [ ] Rendering
  - All lookups (`SubLiturgy`, `Category`, `CanticleTableEntry`, etc.) can be drawn as info boxes
  - `SubLiturgy`
    - [ ] Compiler
- [ ] `BibleReference` to `String`
  - [ ] and TODO in `crates/psalter/lib.rs`
  - [x] Date/Day
- [ ] Lectionary tests against JS versions
  - [ ] RCL
- [ ] Calendar tests
  - [ ] Test feasts like "Eve of Trinity Sunday" etc.
- [ ] Sort and prettify various constant arrays
- [ ] Localization
  - [ ] LiturgicalWeek => color
- [x] PsalmCitation
  - [ ] Allow multiple psalters based on preferences